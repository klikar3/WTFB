
insert mitglieder 
(`MitgliederId`,
`MitgliedsNr`,
`Vorname`,
`Name`,
`Geschlecht`,
`Anrede`,
`GeburtsDatum`,
`PLZ`,
`Wohnort`,
`Strasse`,
`Telefon1`,
`Telefon2`,
`HandyNr`,
`Fax`,
`LetzteAenderung`,
`Email`,
`Beruf`,
`Nationalitaet`,
`BLZ`,
`Bank`,
`IBAN`,
`KontoNr`,
`Status`,
`AktivPassiv`,
`Kontoinhaber`,
`Schulort`,
`Disziplin`,
`Funktion`,
`Sifu`,
`Woher`,
`Graduierung`,
`VDauer`,
`Monatsbeitrag`,
`BeitrittDatum`,
`KuendigungDatum`,
`AustrittDatum`,
`Geburtsort`,
`GruppenArt`,
`Zahlungsart`,
`Zahlungsweise`,
`EinzugZum`,
`BeitragAussetzenVon`,
`BeitragAussetzenBis`,
`BeitragAussetzenGrund`,
`AufnahmegebuehrBezahlt`,
`EWTONr`,
`EWTOAustritt`,
`BeitragOffenAb`,
`BeitragOffenEuro`,
`BeitragOffenBis`,
`Mahngebuehren`,
`GesamtOffen`,
`Mahnung1Am`,
`Mahnung2Am`,
`Mahnung3Am`,
`BarZahlungAm`,
`InkassoAm`,
`Zahlungsfrist`,
`Bemerkungen`,
`Betreff`,
`Text`,
`KontaktAm`,
`KontaktArt`,
`Bemerkung1`,
`EinladungIAzum`,
`WarZumIAda`,
`zumIAnichtDa`,
`ProbetrainingAm`,
`PTwarDa`,
`zumPTnichtDa`,
`VertragAbgeschlossen`,
`VertragMit`,
`Abschlussgespraech`,
`Bemerkung2`,
`WTPruefungZum`,
`WTPruefungAm`,
`KPruefungZum`,
`KPruefungAm`,
`EPruefungZum`,
`EPruefungAm`,
`GutscheinVon`,
`Name2Schule`,
`DM2Schule`,
`NeuerBeitrag`,
`Vereinbarung`,
`RechnungsNr`,
`VErgaenzungAb`,
`Land`,
`AussetzenDauer`,
`Betrag`,
`BezahltAm`,
`ZahlungsweiseBetrag`,
`datumwt1sg`,
`datumwt2sg`,
`datumwt3sg`,
`datumwt4sg`,
`datumwt5sg`,
`datumwt6sg`,
`datumwt7sg`,
`datumwt8sg`,
`datumwt9sg`,
`datumwt10sg`,
`datumwt11sg`,
`datumwt12sg`,
`datumwt1tg`,
`datumwt2tg`,
`datumwt3tg`,
`datumwt4tg`,
`datumwt5pg`,
`AufnahmegebuehrBezahltAm`,
`datumWtPraktikum`,
`datumWtAusbilder1`,
`datumWtAusbilder2`,
`datumWtAusbilder3`,
`datumWtSchulleiter`,
`AufnGebuehrBetrag`,
`SFirm`,
`datumwt1sgk`,
`datumwt2sgk`,
`datumwt3sgk`,
`datumwt4sgk`,
`datumwt5sgk`,
`datumwt6sgk`,
`datumwt7sgk`,
`datumwt8sgk`,
`datumwt9sgk`,
`datumwt10sgk`,
`datumwt11sgk`,
`datumwt12sgk`,
`datume1sg`,
`datume2sg`,
`datume3sg`,
`datume4sg`,
`datume5sg`,
`datume6sg`,
`datume7sg`,
`datume8sg`,
`datume9sg`,
`datume10sg`,
`datume11sg`,
`datume12sg`,
`BListe`,
`DVDgesendetAm`,
`datume11tg`,
`datume12tg`,
`datume21tg`,
`datume22tg`,
`datume31tg`,
`datume32tg`,
`datume41tg`,
`datume42tg`,
`EsckrimaGraduierung`,
`BeginnEsckrima`,
`EndeEsckrima`)
select * from mitglieder_neu as n where not EXISTS
(select 1 from mitglieder where MitgliederId = n.MitgliederId);

UPDATE `wt-data`.`mitglieder` as m, mitglieder_neu as n
SET m.`MitgliedsNr` = CASE n.MitgliedsNr WHEN '' THEN 0 ELSE n.MitgliedsNr END,
m.`Vorname` = n.Vorname,
m.`Name` = n.Name,
m.`Geschlecht` = n.Geschlecht,
m.`Anrede` = n.Anrede,
m.`GeburtsDatum` = CASE n.GeburtsDatum WHEN '0000-00-00 00:00:00' THEN null ELSE n.GeburtsDatum END,
m.`PLZ` = n.PLZ,
m.`Wohnort` = n.Wohnort,
m.`Strasse` = n.Strasse,
m.`Telefon1` = n.Telefon1,
m.`Telefon2` = n.Telefon2,
m.`HandyNr` = n.HandyNr,
m.`Fax` = n.Fax,
m.`LetzteAenderung` = CASE n.LetzteAenderung WHEN '0000-00-00 00:00:00' THEN null ELSE n.LetzteAenderung END,
m.`Email` = n.Email,
m.`Beruf` = n.Beruf,
m.`Nationalitaet` = n.Nationalitaet,
m.`BLZ` = n.BLZ,
m.`Bank` = n.Bank,
/*m.`IBAN` = n.IBAN,*/
m.`KontoNr` = n.KontoNr,
m.`Status` = n.Status,
m.`AktivPassiv` = n.AktivPassiv,
m.`Kontoinhaber` = n.Kontoinhaber,
m.`Schulort` = n.Schulort,
m.`Disziplin` = n.Disziplin,
m.`Funktion` = n.Funktion,
m.`Sifu` = n.Sifu,
m.`Woher` = n.Woher,
m.`Graduierung` = n.Graduierung,
m.`VDauer` = n.VDauer,
m.`Monatsbeitrag` = CASE n.Monatsbeitrag WHEN '0000-00-00 00:00:00' THEN null ELSE n.Monatsbeitrag END,
m.`BeitrittDatum` = CASE n.BeitrittDatum WHEN '0000-00-00 00:00:00' THEN null ELSE n.BeitrittDatum END,
m.`KuendigungDatum` = CASE n.KuendigungDatum WHEN '0000-00-00 00:00:00' THEN null ELSE n.KuendigungDatum END,
m.`AustrittDatum` = CASE n.AustrittDatum WHEN '0000-00-00 00:00:00' THEN null ELSE n.AustrittDatum END,
m.`Geburtsort` = n.Geburtsort,
m.`GruppenArt` = n.GruppenArt,
m.`Zahlungsart` = n.Zahlungsart,
m.`Zahlungsweise` = n.Zahlungsweise,
m.`EinzugZum` = n.EinzugZum,
m.`BeitragAussetzenVon` = CASE n.BeitragAussetzenVon WHEN '0000-00-00 00:00:00' THEN null ELSE n.BeitragAussetzenVon END,
m.`BeitragAussetzenBis` = CASE n.BeitragAussetzenBis WHEN '0000-00-00 00:00:00' THEN null ELSE n.BeitragAussetzenBis END,
m.`BeitragAussetzenGrund` = n.BeitragAussetzenGrund,
m.`AufnahmegebuehrBezahlt` = n.AufnahmegebuehrBezahlt,
m.`EWTONr` = n.EWTONr,
m.`EWTOAustritt` = n.EWTOAustritt,
m.`BeitragOffenAb` = CASE n.BeitragOffenAb WHEN '0000-00-00 00:00:00' THEN null ELSE n.BeitragOffenAb END,
m.`BeitragOffenEuro` = n.BeitragOffenEuro,
m.`BeitragOffenBis` = CASE n.BeitragOffenBis WHEN '0000-00-00 00:00:00' THEN null ELSE n.BeitragOffenBis END,
m.`Mahngebuehren` = n.Mahngebuehren,
m.`GesamtOffen` = n.GesamtOffen,
m.`Mahnung1Am` = CASE n.Mahnung1Am WHEN '0000-00-00 00:00:00' THEN null ELSE n.Mahnung1Am END,
m.`Mahnung2Am` = CASE n.Mahnung2Am WHEN '0000-00-00 00:00:00' THEN null ELSE n.Mahnung2Am END,
m.`Mahnung3Am` = CASE n.Mahnung3Am WHEN '0000-00-00 00:00:00' THEN null ELSE n.Mahnung3Am END,
m.`BarZahlungAm` = CASE n.BarZahlungAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.BarZahlungAm END,
m.`InkassoAm` = n.InkassoAm,
m.`Zahlungsfrist` = n.Zahlungsfrist,
m.`Bemerkungen` = n.Bemerkungen,
m.`Betreff` = n.Betreff,
m.`Text` = n.Text,
m.`KontaktAm` = CASE n.KontaktAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.KontaktAm END,
m.`KontaktArt` = n.KontaktArt,
m.`Bemerkung1` = n.Bemerkung1,
m.`EinladungIAzum` = CASE n.EinladungIAzum WHEN '0000-00-00 00:00:00' THEN null ELSE n.EinladungIAzum END,
m.`WarZumIAda` = CASE n.WarZumIAda WHEN 'WAHR' THEN 1 ELSE 0 END,
m.`zumIAnichtDa` = n.zumIAnichtDa,
m.`ProbetrainingAm` = CASE n.ProbetrainingAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.ProbetrainingAm END,
m.`PTwarDa` = CASE n.PTwarDa WHEN 'WAHR' THEN 1 ELSE 0 END,
m.`zumPTnichtDa` = n.zumPTnichtDa,
m.`VertragAbgeschlossen` = CASE n.VertragAbgeschlossen WHEN 'WAHR' THEN 1 ELSE 0 END,
m.`VertragMit` = n.VertragMit,
m.`Abschlussgespraech` = n.Abschlussgespraech,
m.`Bemerkung2` = n.Bemerkung2,
m.`WTPruefungZum` = n.WTPruefungZum,
m.`WTPruefungAm` = CASE n.WTPruefungAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.WTPruefungAm END,
m.`KPruefungZum` = n.KPruefungZum,
m.`KPruefungAm` = CASE n.KPruefungAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.KPruefungAm END,
m.`EPruefungZum` = n.EPruefungZum,
m.`EPruefungAm` = CASE n.EPruefungAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.EPruefungAm END,
m.`GutscheinVon` = n.GutscheinVon,
m.`Name2Schule` = n.Name2Schule,
m.`DM2Schule` = n.DM2Schule,
m.`NeuerBeitrag` = n.NeuerBeitrag,
m.`Vereinbarung` = n.Vereinbarung,
m.`RechnungsNr` = n.RechnungsNr,
m.`VErgaenzungAb` = CASE n.VErgaenzungAb WHEN '0000-00-00 00:00:00' THEN null ELSE n.VErgaenzungAb END,
m.`Land` = n.Land,
m.`AussetzenDauer` = n.AussetzenDauer,
m.`Betrag` = n.Betrag,
m.`BezahltAm` = CASE n.BezahltAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.BezahltAm END,
m.`ZahlungsweiseBetrag` = n.ZahlungsweiseBetrag,
m.`datumwt1sg` = CASE n.datumwt1sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt1sg END,
m.`datumwt2sg` = CASE n.datumwt2sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt2sg END,
m.`datumwt3sg` = CASE n.datumwt3sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt3sg END,
m.`datumwt4sg` = CASE n.datumwt4sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt4sg END,
m.`datumwt5sg` = CASE n.datumwt5sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt5sg END,
m.`datumwt6sg` = CASE n.datumwt6sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt6sg END,
m.`datumwt7sg` = CASE n.datumwt7sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt7sg END,
m.`datumwt8sg` = CASE n.datumwt8sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt8sg END,
m.`datumwt9sg` = CASE n.datumwt9sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt9sg END,
m.`datumwt10sg` = CASE n.datumwt10sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt10sg END,
m.`datumwt11sg` = CASE n.datumwt11sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt11sg END,
m.`datumwt12sg` = CASE n.datumwt12sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt12sg END,
m.`datumwt1tg` = CASE n.datumwt1tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt1tg END,
m.`datumwt2tg` = CASE n.datumwt2tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt2tg END,
m.`datumwt3tg` = CASE n.datumwt3tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt3tg END,
m.`datumwt4tg` = CASE n.datumwt4tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt4tg END,
m.`datumwt5pg` = CASE n.datumwt5pg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt5pg END,
m.`AufnahmegebuehrBezahltAm` = CASE n.AufnahmegebuehrBezahltAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.AufnahmegebuehrBezahltAm END,
m.`datumWtPraktikum` = CASE n.datumWtPraktikum WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumWtPraktikum END,
m.`datumWtAusbilder1` = CASE n.datumWtAusbilder1 WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumWtAusbilder1 END,
m.`datumWtAusbilder2` = CASE n.datumWtAusbilder2 WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumWtAusbilder2 END,
m.`datumWtAusbilder3` = CASE n.datumWtAusbilder3 WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumWtAusbilder3 END,
m.`datumWtSchulleiter` = CASE n.datumWtSchulleiter WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumWtSchulleiter END,
m.`AufnGebuehrBetrag` = n.AufnGebuehrBetrag,
m.`SFirm` = n.SFirm,
m.`datumwt1sgk` = CASE n.datumwt1sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt1sgk END,
m.`datumwt2sgk` = CASE n.datumwt2sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt2sgk END,
m.`datumwt3sgk` = CASE n.datumwt3sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt3sgk END,
m.`datumwt4sgk` = CASE n.datumwt4sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt4sgk END,
m.`datumwt5sgk` = CASE n.datumwt5sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt5sgk END,
m.`datumwt6sgk` = CASE n.datumwt6sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt6sgk END,
m.`datumwt7sgk` = CASE n.datumwt7sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt7sgk END,
m.`datumwt8sgk` = CASE n.datumwt8sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt8sgk END,
m.`datumwt9sgk` = CASE n.datumwt9sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt9sgk END,
m.`datumwt10sgk` = CASE n.datumwt10sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt10sgk END,
m.`datumwt11sgk` = CASE n.datumwt11sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt11sgk END,
m.`datumwt12sgk` = CASE n.datumwt12sgk WHEN '0000-00-00 00:00:00' THEN null ELSE n.datumwt12sgk END,
m.`datume1sg` = CASE n.datume1sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume1sg END,
m.`datume2sg` = CASE n.datume2sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume2sg END,
m.`datume3sg` = CASE n.datume3sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume3sg END,
m.`datume4sg` = CASE n.datume4sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume4sg END,
m.`datume5sg` = CASE n.datume5sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume5sg END,
m.`datume6sg` = CASE n.datume6sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume6sg END,
m.`datume7sg` = CASE n.datume7sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume7sg END,
m.`datume8sg` = CASE n.datume8sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume8sg END,
m.`datume9sg` = CASE n.datume9sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume9sg END,
m.`datume10sg` = CASE n.datume10sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume10sg END,
m.`datume11sg` = CASE n.datume11sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume11sg END,
m.`datume12sg` = CASE n.datume12sg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume12sg END,
m.`BListe` = n.BListe,
m.`DVDgesendetAm` = CASE n.DVDgesendetAm WHEN '0000-00-00 00:00:00' THEN null ELSE n.DVDgesendetAm END,
m.`datume11tg` = CASE n.datume11tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume11tg END,
m.`datume12tg` = CASE n.datume12tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume12tg END,
m.`datume21tg` = CASE n.datume21tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume21tg END,
m.`datume22tg` = CASE n.datume22tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume22tg END,
m.`datume31tg` = CASE n.datume31tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume31tg END,
m.`datume32tg` = CASE n.datume32tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume32tg END,
m.`datume41tg` = CASE n.datume41tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume41tg END,
m.`datume42tg` = CASE n.datume42tg WHEN '0000-00-00 00:00:00' THEN null ELSE n.datume42tg END,
m.`EsckrimaGraduierung` = n.EsckrimaGraduierung,
m.`BeginnEsckrima` = n.BeginnEsckrima,
m.`EndeEsckrima` = n.EndeEsckrima
/*`PruefungZum` = n.PruefungZum,
`GD` = n.GD,
`BIC` = n.BIC,
`mig_int` = n.mig_int*/

WHERE m.`MitgliederId` = n.`MitgliederId` 
;

